<script setup lang="ts">
import { onMounted } from "vue";
import OpenApiEdit from '@/components/core/OpenApiEdit.vue';
import MonacoEditor from '@/components/core/MonacoEditor.vue';
import { useRuntimeClass, getProperties, RuntimeClassDefinition } from '../../libs/k8s/RuntimeClass.js'
const { onlyReadProperties, editor, setItemFromRoute } = useRuntimeClass();setItemFromRoute();
const emit = defineEmits(['update:model'])
const props = defineProps<{model: object}>();
</script>
<template>
  <q-card bordered class="q-ma-sm">
    <q-tabs v-model="editor.tab" class="bg-primary text-grey-4" active-color="white">
      <q-tab label="Simple" name="simple" />
      <q-tab label="full Yaml" name="yaml" />
    </q-tabs>
    <q-tab-panels v-model="editor.tab" animated>
      <q-tab-panel name="simple">
        <OpenApiEdit
          :in="model['overhead']"
          @update:out="(v)=>editor.setkey('overhead', v)"
          :properties="getProperties(RuntimeClassDefinition.properties.overhead)"
        />
        <OpenApiEdit
          :in="model['scheduling']"
          @update:out="(v)=>editor.setkey('scheduling', v)"
          :properties="getProperties(RuntimeClassDefinition.properties.scheduling)"
        />
      </q-tab-panel>
      <q-tab-panel name="yaml">
          <MonacoEditor
            :text="editor.yaml" :key="editor.yaml"
            @update:text="v=>editor.setYaml(v)"
            :properties="getProperties({properties: Object.fromEntries(Object.entries(RuntimeClassDefinition).filter(([n])=>!['metadata','status'].includes(n)))})"
            />
      </q-tab-panel>
    </q-tab-panels>
  </q-card>
</template>
