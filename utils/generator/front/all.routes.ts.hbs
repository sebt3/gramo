import { createRouter, createWebHistory, RouteRecordRaw } from 'vue-router'
import {menuLinksProps} from './interfaces.js';
import { useConfigStore } from '../stores'
export * from './interfaces.js'
const { defaultRoute } = useConfigStore()
const routeChildren:Array<RouteRecordRaw> = [];
const linkRedirect = {name:''};
export const links:Array<menuLinksProps> = [];

{{#each categories}}
import { route as {{this}}Route, link as {{this}}Link } from './{{this}}'
if ({{this}}Route.children != undefined && {{this}}Route.children?.length>0) {
  routeChildren.push({{this}}Route);
  {{#if (eq this 'system')}}
  if ({{this}}Route.children?.length>2) links.push({{this}}Link)
  {{else}}
  links.push({{this}}Link)
  {{/if}}
  linkRedirect.name = linkRedirect.name!=''?linkRedirect.name:{{this}}Route.redirect!=undefined?{{this}}Route.redirect.name:''
}
{{/each}}

export const router = createRouter({
  history: createWebHistory('/'),
  routes: [
    {
      path: '/',
      name: 'root',
      meta:      {breadcrumb: '', icon: 'home', ns: false},
      redirect: defaultRoute!=''?{path:defaultRoute}:linkRedirect,
      children: routeChildren
    },
    { path: '/:pathMatch(.*)*', name: 'NotFound', component: () => import('../components/navigation/PageNotFound.vue') },
  ]
})
export default router